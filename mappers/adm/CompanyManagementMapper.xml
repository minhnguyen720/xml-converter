<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dou.adm.mappers.CompanyManagementMapper">
    <resultMap id="UI_ADM_001Map" type="UI_ADM_001VO">
        <result property="coCd" column="CO_CD" javaType="String"/>
        <result property="coNm" column="CO_NM" javaType="String"/>
        <result property="ceoNm" column="CEO_NM" javaType="String"/>
        <result property="addr" column="ADDR" javaType="String"/>
        <result property="coTpCd" column="CO_TP_CD" javaType="String"/>
        <result property="coTpNm" column="CO_TP_CD"/>
        <result property="contactUsrId" column="CONTACT_USR_ID"/>
        <result property="contactPersonNm" column="CONTACT_PERSON_NM"/>
        <result property="contactPersonEmail" column="USR_EML" javaType="String"/>
        <result property="mnPhnNo" column="MPHN_NO" javaType="String"/>
        <result property="cntCd" column="CNT_CD"/>
        <result property="ctyNm" column="CTY_NM"/>
        <result property="createDate" column="cre_dt"/>
        <result property="updateDate" column="upd_dt"/>
        <result property="createUserNm" column="cre_usr_nm"/>
        <result property="updateUserNm" column="upd_usr_nm"/>
        <result property="createUser" column="cre_usr_id"/>
        <result property="updateUser" column="upd_usr_id"/>
        <result property="cntCd" column="CNT_CD"/>
        <result property="cntNm" column="CNT_NM"/>
        <result property="deltFlg" column="DELT_FLG"/>
    </resultMap>

    <resultMap id="AdmComCoMap" type="AdmCoVO">
        <result property="coCd" column="CO_CD" javaType="String"/>
        <result property="coNm" column="CO_NM" javaType="String"/>
        <result property="ceoNm" column="CEO_NM" javaType="String"/>
        <result property="addr" column="ADDR" javaType="String"/>
        <result property="coTpCd" column="CO_TP_CD" javaType="String"/>
        <result property="contactUsrId" column="CONTACT_USR_ID" javaType="String"/>
        <result property="cntCd" column="CNT_CD" javaType="String"/>
        <result property="ctyNm" column="CTY_NM" javaType="String"/>
        <result property="endTmNo" column="END_TM_NO" javaType="Float"/>
        <result property="lunHrNo" column="LUN_HR_NO" javaType="Float"/>
        <result property="stLunTmNo" column="ST_LUN_TM_NO" javaType="Float"/>
        <result property="stTmNo" column="ST_TM_NO" javaType="Float"/>
        <result property="wrkHrNo" column="WRK_HR_NO" javaType="Float"/>
        <result property="wrkDyCd" column="WRK_DY_CD" javaType="String"/>
        <result property="utcTmNo" column="UTC_TM_NO" javaType="Float"/>
        <result property="deltFlg" column="DELT_FLG" javaType="String"/>
        <result property="creUsrId" column="cre_usr_id"/>
        <result property="updUsrId" column="upd_usr_id"/>
        <result property="creDt" column="cre_dt"/>
        <result property="updDt" column="upd_dt"/>
    </resultMap>

    <resultMap type="AdmComCdVO" id="CombineComCdVOMap">
        <result property="comCd" column="COM_CD" javaType="String"/>
        <result property="prntCd" column="PRNT_CD" javaType="String"/>
        <result property="cdNm" column="CD_NM" javaType="String"/>
        <result property="cdColor" column="COLR_VAL" javaType="String"/>
        <result property="cdShrtNm" column="CD_SHRT_NM" javaType="String"/>
        <result property="imgUrl" column="IMG_URL" javaType="String"/>
        <result property="ordByNo" column="ORD_BY_NO" javaType="Integer"/>
    </resultMap>

    <select id="selectAllCompany" resultMap="UI_ADM_001Map">
        SELECT /** tmg.PartnerManagement.selectAllCompany */
        co.co_cd,
        co.co_nm,
        co.ceo_nm,
        co.addr,
        co.co_tp_cd,
        co.contact_usr_id,
        usr.usr_nm AS contact_person_nm,
        usr.usr_eml,
        usr.mphn_no,
        co.cnt_cd,
        (
        SELECT
        adm_cnt.cnt_nm
        FROM
        adm_cnt
        WHERE
        adm_cnt.cnt_cd = co.cnt_cd
        ) AS cnt_nm,
        co.cty_nm,
        TO_CHAR(co.cre_dt, 'DD/MM/YYYY') cre_dt,
        TO_CHAR(co.upd_dt, 'DD/MM/YYYY') upd_dt,
        (
        SELECT usr_nm
        FROM adm_usr
        WHERE adm_usr.usr_id = co.cre_usr_id
        ) AS cre_usr_nm,
        (
        SELECT usr_nm
        FROM adm_usr
        WHERE adm_usr.usr_id = co.upd_usr_id
        ) AS upd_usr_nm,
        co.cre_usr_id,
        co.upd_usr_id,
        co.DELT_FLG
        FROM adm_co co,
        adm_usr usr
        WHERE 1 = 1
        AND co.contact_usr_id = usr.usr_id (+)
        <if test="deltFlg == false">
            AND co.delt_flg = 'N'
        </if>
        <if test="deltFlg == true">
            AND co.delt_flg = 'Y'
        </if>
        <if test="coTpCd != null">
            and upper(co.CO_TP_CD) = #{coTpCd}
        </if>
        <if test="coNm != null">
            and upper(co.CO_NM) like '%' || upper(#{coNm}) || '%'
        </if>
        <if test="isMaster != true">
            AND co.CRE_BY_CO_CD = #{creByCoCd}
        </if>
        <if test="coCd != null">
            AND co.CO_CD = #{coCd}
        </if>
        ORDER BY co.cre_dt DESC
    </select>

    <select id="selectCombineComCdByPrntCdList" resultMap="CombineComCdVOMap">
        select /** mcm.CommonCode.selectCombineComCdByPrntCdList */
        PRNT_CD,
        CONCAT(PRNT_CD, COM_CD) as COM_CD,
        CD_NM,
        COLR_VAL,
        CD_SHRT_NM,
        IMG_URL,
        ORD_BY_NO
        from ADM_COM_CD
        where 1 = 1
        <if test="comCdList != null and comCdList.size() &gt; 0">
            <trim prefix="and PRNT_CD in ">
                <foreach item="item" index="index" collection="comCdList"
                         open="(" separator="," close=")">
                    #{item}
                </foreach>
            </trim>
        </if>
        and (USE_FLG IS NULL OR UPPER(USE_FLG) = 'Y')
        and (DELT_STS_FLG IS NULL OR UPPER(DELT_STS_FLG) != 'Y')
        order by ORD_BY_NO ASC, CD_NM ASC
    </select>

    <select id="selectBizCondNm">
        select /** pja.PartnerManagement.selectSubCdNm*/
            CD_NM
        from ADM_COM_CD
        where CONCAT(PRNT_CD, COM_CD) = #bzctCd#
    </select>

    <select id="selectNumberTeamOfCompany" resultType="String">
        select /** tmg.PartnerManagement.selectNumberTeamOfCompany */
            count(*)
        from ADM_TEAM
        where CO_CD = #coCd#
    </select>

    <insert id="insert">
		insert  /** AdmCo.insert */
		into ADM_CO(
				CO_CD,
				CO_NM,
				CEO_NM,
				ADDR,
				CO_TP_CD,
				CONTACT_USR_ID,
				CNT_CD,
				CTY_NM,
				END_TM_NO,
				LUN_HR_NO,
				ST_LUN_TM_NO,
				ST_TM_NO,
				WRK_HR_NO,
				WRK_DY_CD,
				UTC_TM_NO,
				DELT_FLG,
				CRE_BY_CO_CD,
				cre_usr_id, cre_dt, upd_usr_id, upd_dt
				)
		values(
				#{coCd},
				#{coNm},
				#{ceoNm},
				#{addr},
				#{coTpCd},
				#{contactUsrId},
				#{cntCd},
				#{ctyNm},
				#{endTmNo},
				#{lunHrNo},
				#{stLunTmNo},
				#{stTmNo},
				#{wrkHrNo},
				#{wrkDyCd},
				#{utcTmNo},
				#{deltFlg},
				#{creByCoCd},
				#{createUser}, sysdate, #{updateUser}, sysdate
				)
	</insert>

    <resultMap type="AdmCoVO" id="AdmCoMap">
        <result property="coCd" column="CO_CD" javaType="String"/>
        <result property="coNm" column="CO_NM" javaType="String"/>
        <result property="ceoNm" column="CEO_NM" javaType="String"/>
        <result property="addr" column="ADDR" javaType="String"/>
        <result property="coTpCd" column="CO_TP_CD" javaType="String"/>
        <result property="contactUsrId" column="CONTACT_USR_ID" javaType="String"/>
        <result property="cntCd" column="CNT_CD" javaType="String"/>
        <result property="ctyNm" column="CTY_NM" javaType="String"/>
        <result property="endTmNo" column="END_TM_NO" javaType="Float"/>
        <result property="lunHrNo" column="LUN_HR_NO" javaType="Float"/>
        <result property="stLunTmNo" column="ST_LUN_TM_NO" javaType="Float"/>
        <result property="stTmNo" column="ST_TM_NO" javaType="Float"/>
        <result property="wrkHrNo" column="WRK_HR_NO" javaType="Float"/>
        <result property="wrkDyCd" column="WRK_DY_CD" javaType="String"/>
        <result property="utcTmNo" column="UTC_TM_NO" javaType="Float"/>
        <result property="deltFlg" column="DELT_FLG" javaType="String"/>
        <result property="createUser" column="cre_usr_id" />
        <result property="updateUser" column="upd_usr_id" />
        <result property="createDate" column="cre_dt" />
        <result property="updateDate" column="upd_dt" />
    </resultMap>
    <select id="selectByKey" resultMap="AdmCoMap">
		select 	/** AdmCo.selectByKey */
				CO_CD,
				CO_NM,
				CEO_NM,
				ADDR,
				CO_TP_CD,
				CONTACT_USR_ID,
				CNT_CD,
				CTY_NM,
				END_TM_NO,
				LUN_HR_NO,
				ST_LUN_TM_NO,
				ST_TM_NO,
				WRK_HR_NO,
				WRK_DY_CD,
				UTC_TM_NO,
				DELT_FLG,
				cre_usr_id, cre_dt, upd_usr_id, upd_dt
		from	ADM_CO
		where	1 = 1
		and		CO_CD = #{coCd}
	</select>

    <update id="updateWithMap">
        update  /** AdmCo.updateWithMap */
        ADM_CO set
        <if test="coCd != null and coCd != ''">
            CO_CD = #{coCd},
        </if>
        <if test="coNm != null">
            CO_NM = #{coNm},
        </if>
        <if test="ceoNm != null">
            CEO_NM = #{ceoNm},
        </if>
        <if test="addr != null">
            ADDR = #{addr},
        </if>
        <if test="coTpCd != null">
            CO_TP_CD = #{coTpCd},
        </if>
        <if test="contactUsrId != null and contactUsrId != ''">
            CONTACT_USR_ID = #{contactUsrId},
        </if>
        <if test="cntCd != null and cntCd != ''">
            CNT_CD = #{cntCd},
        </if>
        <if test="ctyNm != null">
            CTY_NM = #{ctyNm},
        </if>
        <if test="endTmNo != null and endTmNo != ''">
            END_TM_NO = #{endTmNo},
        </if>
        <if test="lunHrNo != null and lunHrNo != ''">
            LUN_HR_NO = #{lunHrNo},
        </if>
        <if test="stLunTmNo != null and stLunTmNo != ''">
            ST_LUN_TM_NO = #{stLunTmNo},
        </if>
        <if test="stTmNo != null and stTmNo != ''">
            ST_TM_NO = #{stTmNo},
        </if>
        <if test="wrkHrNo != null and wrkHrNo != ''">
            WRK_HR_NO = #{wrkHrNo},
        </if>
        <if test="wrkDyCd != null and wrkDyCd != ''">
            WRK_DY_CD = #{wrkDyCd},
        </if>
        <if test="utcTmNo != null and utcTmNo != ''">
            UTC_TM_NO = #{utcTmNo},
        </if>
        <if test="deltFlg != null and deltFlg != ''">
            DELT_FLG = #{deltFlg},
        </if>
        upd_usr_id = #{updateUser},
        upd_dt = sysdate
        where	1 = 1
        and		CO_CD = #{coCd}
    </update>
</mapper>